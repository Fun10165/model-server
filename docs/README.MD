# 公文笔杆子服务使用文档

## 概述
本服务提供强大的文档处理与内容生成能力，支持多种输入格式和智能化输出。

## 输入方式
*   **文字**：通过聊天框直接输入。
*   **文件**：支持上传以下格式：
    *   **文档类**：`.docx`, `.pptx`, `.xlsx`, `.pdf`
    *   **音频类**：`.audio` (常见音频格式)
    *   **图像类**：`.image` (常见图片格式)
    *   **文本类**：`.txt`
    *   **其他类**：其他格式文件将尝试直接处理。

## 核心功能与服务

1.  **文件转写与内容提取**
    *   **文档类 (.docx, .pptx, .xlsx, .pdf)**：提取所有文字内容，并结合图片信息生成完整的文档转写。
    *   **音频类 (.audio)**：提取音频中的文字内容（语音转写）。
    *   **图像类 (.image)**：结合用户输入的文字描述与图片内容，生成详细的图片解读（使用 `doubao-seed-1-6` 模型进行深度图像理解）。
    *   **其他格式**：尝试直接提取或处理文件内容。

2.  **智能文案生成**
    *   **操作**：在成功解析文档内容后，输入指令：
        *   `开始生成微博文案`：一键生成适合微博平台的文案。
        *   `开始生成公众号文案`：一键生成适合微信公众号的文案（输出为Markdown格式）。
    *   **公众号文案使用**：将生成的Markdown粘贴至[微信公众号官方排版工具](https://md.phodal.com)（或其他兼容工具），可转换为可直接复制到微信公众号编辑器的HTML代码。

3.  **智能PPT生成**
    *   **操作**：在成功解析文档内容后，输入指令：`开始生成幻灯片`。
    *   **默认参数**：
        *   包含AI生成的配图
        *   生成PPT演讲者备注
        *   启用联网搜索（补充信息）
        *   输出语言：中文

4.  **RAG与网络搜索增强**
    *   **操作**：
        1.  输入指令：`调用网络搜索和知识库更新文档`。
        2.  输入具体的更新请求（例如：“查找关于XX政策的最新解读并补充到文档中”）。
    *   **功能**：利用检索增强生成（RAG）技术和网络搜索，获取最新或相关知识库信息，丰富和更新当前处理的文档内容。
    *   **存储**：更新后的文档**将存储**，可用于后续的 **文案生成 (功能2)** 和 **PPT生成 (功能3)**。

5.  **MCP (Model Context Protocol) 能力**
    *   **说明**：MCP能力提供极强的功能扩展性，理论上可实现计算机系统中已有的广泛功能。

## 开发者功能 (调试用)

*   **Bypass & 初始化**：使用 `bypass` 指令可直接跳转到流程结束节点，并初始化临时变量。
    *   **注意**：此操作**不会清除**当前加载的文档内容。如需清除文档，请直接清空聊天上下文。